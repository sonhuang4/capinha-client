import{r as d,a as m,j as e,S as L}from"./app-CyxJLvEq.js";import{C as M}from"./card-BNIH3Pud.js";import{B as x}from"./button-CqV8ksUr.js";import{I as B}from"./input-gOr3B0Id.js";import{B as b}from"./badge-StFwuwMu.js";import{S as G}from"./switch-CnN6dfTm.js";import{A as R}from"./admin-layouts-C_-6wHD8.js";import{D as U,a as H,b as Y,d as f,e as J,f as K,g as Q,h as X}from"./dialog-D5JvYGXV.js";import{P as Z}from"./plus-BSo03-rQ.js";import{S as ee}from"./search-B3dx1j76.js";import{c as ae}from"./createLucideIcon-BC5KCFBC.js";import{E as se}from"./eye-BLGYhTyn.js";import{C as te}from"./check-DEIm2C7q.js";import{C as re}from"./copy-CbUrAze4.js";import{M as oe}from"./message-circle-ClvsUYFb.js";import{M as T}from"./mail-BGSldGCu.js";import{S as le}from"./share-2-CcxmfxN4.js";import"./utils-jAU0Cazi.js";import"./index-C1-QZkgV.js";import"./index-B2CxUIcs.js";import"./index-fYyqQwJ9.js";import"./x-DL39Suzq.js";import"./credit-card-4iYNl23j.js";import"./chart-column-Cxs-ItVH.js";import"./settings-D-KavAww.js";import"./AnimatedBackground-BHLy8l2X.js";import"./sun-sNYqJswG.js";/**
 * @license lucide-react v0.475.0 - ISC
 *
 * This source code is licensed under the ISC license.
 * See the LICENSE file in the root directory of this source tree.
 */const ie=[["path",{d:"M10 5a2 2 0 0 0-1.344.519l-6.328 5.74a1 1 0 0 0 0 1.481l6.328 5.741A2 2 0 0 0 10 19h10a2 2 0 0 0 2-2V7a2 2 0 0 0-2-2z",key:"1yo7s0"}],["path",{d:"m12 9 6 6",key:"anjzzh"}],["path",{d:"m18 9-6 6",key:"1fp51s"}]],ne=ae("Delete",ie),Pe=()=>{const[p,j]=d.useState([]),[h,w]=d.useState(""),[o,$]=d.useState(null),[de,ce]=d.useState(!1),[D,y]=d.useState(!1),[v,C]=d.useState(new Set),[c,g]=d.useState("all"),[me,xe]=d.useState(!1),[k,S]=d.useState(!1);d.useEffect(()=>{E()},[]);const E=async()=>{var a,r;try{S(!0);const t=await m.get("/cards");j(t.data)}catch(t){console.error("Erro ao carregar cartões:",t),alert("Erro ao carregar cartões: "+(((r=(a=t.response)==null?void 0:a.data)==null?void 0:r.message)||t.message))}finally{S(!1)}},N=p.filter(a=>{const r=a.name.toLowerCase().includes(h.toLowerCase())||String(a.id).includes(h),t=c==="all"||a.status===c;return r&&t}),z=async a=>{var r,t;try{const i=(await m.put(`/cards/${a}/toggle-status`)).data;j(n=>n.map(l=>l.id===a?{...l,status:i.status}:l))}catch(s){console.error("Falha ao alternar o status do cartão:",s),alert("Erro ao alterar status: "+(((t=(r=s.response)==null?void 0:r.data)==null?void 0:t.message)||s.message))}},_=async a=>{var r,t;if(confirm(`⚠️ Confirmação de Exclusão

Tem certeza que deseja deletar o cartão de "${a.name}"?

Esta ação não pode ser desfeita e o cartão será permanentemente removido.`))try{await m.delete(`/cards/${a.id}`),j(s=>s.filter(i=>i.id!==a.id)),alert(`Sucesso!

Cartão deletado com sucesso!`)}catch(s){console.error("Failed to delete card:",s),((r=s.response)==null?void 0:r.status)===403?alert(`Erro!

Você não tem permissão para deletar este cartão.`):((t=s.response)==null?void 0:t.status)===404?alert(`Erro!

Cartão não encontrado.`):alert(`Erro!

Não foi possível deletar o cartão. Tente novamente.`)}},W=a=>{$(a),y(!0)},O=async a=>{var r,t;try{const s=await m.get(`/cards/${a.id}/short-link`);if(s.data.success){const{short_link:i}=s.data;await navigator.clipboard.writeText(i),C(n=>new Set([...n,a.id])),setTimeout(()=>{C(n=>{const l=new Set(n);return l.delete(a.id),l})},2e3),alert("Link copiado! Link curto copiado para a área de transferência")}else throw new Error(s.data.message||"Failed to get short link")}catch(s){console.error("Falha ao copiar link curto:",s),alert("Falha ao copiar link curto: "+(((t=(r=s.response)==null?void 0:r.data)==null?void 0:t.message)||s.message))}},I=async a=>{var r,t;try{console.log("Calling:",`/cards/${a.id}/whatsapp-share`);const s=await m.get(`/cards/${a.id}/whatsapp-share`);if(s.data.success){const{whatsapp_url:i,fallback_message:n}=s.data;console.log("Got WhatsApp URL:",i);const l=window.open(i,"_blank");setTimeout(()=>{(!l||l.closed)&&navigator.clipboard.writeText(n).then(()=>{alert("Link do WhatsApp bloqueado. Mensagem copiada para a área de transferência! Cole-a manualmente no WhatsApp.")}).catch(()=>{alert(`Link do WhatsApp bloqueado. Mensagem copiada para a área de transferência! Cole-a manualmente no WhatsApp.

${n}`)})},1e3)}else throw new Error(s.data.message||"Failed to get WhatsApp share")}catch(s){console.error("Falha ao obter o link do WhatsApp:",s),alert("Erro: Falha ao gerar link do WhatsApp - "+(((t=(r=s.response)==null?void 0:r.data)==null?void 0:t.message)||s.message))}},P=async a=>{var r,t;try{const s=await m.get(`/cards/${a.id}/email-share`);if(s.data.success){const{subject:i,body:n}=s.data,l="Subject: "+i+`

To: [Enter recipient email]

`+n;navigator.clipboard.writeText(l).then(()=>{alert(`Conteúdo do e-mail copiado para a área de transferência!

Agora você pode:
1. Abrir o Gmail/Yahoo/Outlook
2. Colar o conteúdo
3. Adicionar o e-mail do destinatário
4. Enviar!`)}).catch(()=>{prompt("Copie este conteúdo de e-mail manualmente:",l)})}else throw new Error(s.data.message||"Failed to get email share")}catch(s){console.error("Falha ao obter dados de e-mail:",s),alert("Erro: Falha ao gerar conteúdo de e-mail - "+(((t=(r=s.response)==null?void 0:r.data)==null?void 0:t.message)||s.message))}},V=async a=>{var r,t;if(!a.email){alert("⚠️ Este cartão não possui endereço de e-mail. Adicione um e-mail primeiro.");return}if(confirm("Enviar email de ativação para: "+a.email+"?"))try{const s=await m.get(`/cards/${a.id}/send-email`);s.data.success?alert("✅ E-mail enviado com sucesso para: "+s.data.recipient):alert("❌ Falha: "+s.data.message)}catch(s){console.error("Erro ao enviar e-mail:",s),alert("❌ Falha ao enviar o e-mail: "+(((t=(r=s.response)==null?void 0:r.data)==null?void 0:t.message)||s.message))}},q=async a=>{var r,t;try{const s=await m.get(`/cards/${a.id}/sharing-options`);if(s.data.success)return s.data;throw new Error(s.data.message||"Failed to get sharing options")}catch(s){return console.error("Falha ao obter opções de compartilhamento:",s),alert("Erro ao obter opções de compartilhamento: "+(((t=(r=s.response)==null?void 0:r.data)==null?void 0:t.message)||s.message)),null}},u=async(a,r)=>{const t=await q(a);if(!t)return;let s="";switch(r){case"twitter":s=t.social.twitter;break;case"linkedin":s=t.social.linkedin;break;case"facebook":s=t.social.facebook;break;case"sms":s=t.sms.url;break}s&&window.open(s,"_blank")},A=p.filter(a=>a.status==="activated").length,F=p.filter(a=>a.status==="pending").length;return e.jsx(R,{children:e.jsxs("div",{className:"min-h-screen relative",children:[e.jsxs("div",{className:"absolute inset-0 -z-10",children:[e.jsx("div",{className:"absolute inset-0 bg-gradient-to-br from-blue-50 via-purple-50 to-pink-50 dark:from-gray-900 dark:via-purple-900/20 dark:to-blue-900/20"}),e.jsx("div",{className:"absolute inset-0 bg-[radial-gradient(circle_at_50%_120%,rgba(120,119,198,0.1),rgba(255,255,255,0))]"})]}),e.jsxs("div",{className:"p-4 sm:p-6 lg:p-8 space-y-6",children:[e.jsxs("div",{className:"flex flex-col space-y-4 sm:space-y-0 sm:flex-row sm:items-center sm:justify-between",children:[e.jsxs("div",{className:"space-y-1",children:[e.jsx("h1",{className:"text-2xl sm:text-3xl font-bold bg-gradient-to-r from-purple-600 to-blue-600 bg-clip-text text-transparent",children:"Gestão de Cartões de Visita"}),e.jsx("p",{className:"text-sm sm:text-base text-muted-foreground",children:"Crie e gerencie cartões de visita digitais"}),e.jsxs("div",{className:"flex flex-wrap gap-2 sm:gap-4 pt-2",children:[e.jsxs("div",{className:"flex items-center gap-1 text-xs sm:text-sm",children:[e.jsx("span",{className:"text-muted-foreground",children:"Total:"}),e.jsx(b,{variant:"outline",className:"text-xs",children:p.length})]}),e.jsxs("div",{className:"flex items-center gap-1 text-xs sm:text-sm",children:[e.jsx("span",{className:"text-muted-foreground",children:"Ativo:"}),e.jsx(b,{variant:"default",className:"text-xs bg-green-100 text-green-800",children:A})]}),e.jsxs("div",{className:"flex items-center gap-1 text-xs sm:text-sm",children:[e.jsx("span",{className:"text-muted-foreground",children:"Pendente:"}),e.jsx(b,{variant:"secondary",className:"text-xs",children:F})]})]})]}),e.jsxs(x,{className:"w-full sm:w-auto gradient-button",onClick:()=>L.visit("/client/dashboard"),children:[e.jsx(Z,{className:"w-4 h-4 mr-2"}),e.jsx("span",{className:"sm:inline",children:"Criar cartão"})]})]}),e.jsx(M,{className:"material-card p-4 sm:p-6 animate-fade-in",children:e.jsxs("div",{className:"space-y-4",children:[e.jsxs("div",{className:"relative w-full",children:[e.jsx(ee,{className:"absolute left-3 top-1/2 transform -translate-y-1/2 text-muted-foreground w-4 h-4"}),e.jsx(B,{placeholder:"Search by name or card ID...",value:h,onChange:a=>w(a.target.value),className:"pl-10 w-full"})]}),e.jsxs("div",{className:"flex flex-wrap gap-2",children:[e.jsx(x,{size:"sm",variant:c==="all"?"default":"outline",onClick:()=>g("all"),className:"text-xs sm:text-sm",children:"Todos os cartões"}),e.jsxs(x,{size:"sm",variant:c==="activated"?"default":"outline",onClick:()=>g("activated"),className:"text-xs sm:text-sm",children:["Ativo (",A,")"]}),e.jsxs(x,{size:"sm",variant:c==="pending"?"default":"outline",onClick:()=>g("pending"),className:"text-xs sm:text-sm",children:["Pendente (",F,")"]}),e.jsxs("div",{className:"ml-auto flex items-center gap-2 text-xs sm:text-sm text-muted-foreground",children:[e.jsx("span",{children:"Showing:"}),e.jsx(b,{variant:"outline",className:"text-xs",children:N.length})]})]}),e.jsx("div",{className:"flex justify-end",children:e.jsx(x,{variant:"outline",size:"sm",onClick:E,disabled:k,className:"text-xs",children:k?"Carregando...":"Atualizar"})})]})}),e.jsx(M,{className:"material-card p-4 sm:p-6 animate-fade-in",children:k?e.jsx("div",{className:"p-8 text-center text-muted-foreground",children:e.jsxs("div",{className:"space-y-2",children:[e.jsx("p",{className:"text-lg font-medium",children:"Carregando cartões..."}),e.jsx("div",{className:"flex justify-center",children:e.jsx("div",{className:"animate-spin rounded-full h-8 w-8 border-b-2 border-blue-600"})})]})}):N.length===0?e.jsx("div",{className:"p-8 text-center text-muted-foreground",children:h||c!=="all"?e.jsxs("div",{className:"space-y-2",children:[e.jsx("p",{className:"text-lg font-medium",children:"Nenhum cartão encontrado"}),e.jsxs("p",{className:"text-sm",children:[h&&`Nenhum cartão corresponde a "${h}". `,c!=="all"&&`Nenhum cartão ${c} encontrado. `,"Tente ajustar sua pesquisa ou filtro."]}),e.jsx(x,{variant:"outline",size:"sm",onClick:()=>{w(""),g("all")},className:"mt-4",children:"Limpar Filtros"})]}):e.jsxs("div",{className:"space-y-2",children:[e.jsx("p",{className:"text-lg font-medium",children:"Nenhum cartão ainda"}),e.jsx("p",{className:"text-sm",children:"Crie seu primeiro cartão de visita digital para começar."})]})}):e.jsx("div",{className:"grid grid-cols-1 sm:grid-cols-2 lg:grid-cols-3 xl:grid-cols-4 gap-4",children:N.map(a=>e.jsx("div",{className:"group relative",children:e.jsxs("div",{className:`relative rounded-xl p-5 transition-all duration-300 hover:scale-[1.02] hover:shadow-xl ${a.status==="activated"?"bg-gradient-to-br from-emerald-50 to-teal-50 dark:from-emerald-950/50 dark:to-teal-950/50 border border-emerald-200/60 dark:border-emerald-700/50":"bg-gradient-to-br from-amber-50 to-orange-50 dark:from-amber-950/50 dark:to-orange-950/50 border border-amber-200/60 dark:border-amber-700/50"}`,children:[e.jsxs("div",{className:"flex items-start justify-between mb-4",children:[e.jsxs("div",{className:"flex-1 min-w-0",children:[e.jsxs("div",{className:"flex items-center gap-2 mb-2",children:[e.jsx("h3",{className:"font-bold text-base text-gray-900 dark:text-white truncate",children:a.name}),e.jsx("div",{className:`w-2 h-2 rounded-full ${a.status==="activated"?"bg-emerald-500":"bg-amber-500"}`})]}),e.jsxs("div",{className:"space-y-1",children:[e.jsxs("div",{className:"flex items-center gap-2 text-xs text-gray-600 dark:text-gray-400",children:[e.jsxs("span",{className:"font-mono bg-white/60 dark:bg-gray-800/60 px-2 py-0.5 rounded-md",children:["#",a.id]}),e.jsxs("span",{className:"flex items-center gap-1",children:[e.jsx("div",{className:"w-1 h-1 bg-gray-400 rounded-full"}),a.clickCount||0," clicks"]})]}),a.email&&e.jsx("div",{className:"text-xs text-blue-600 dark:text-blue-400 truncate",children:a.email})]})]}),e.jsx(G,{checked:a.status==="activated",onCheckedChange:()=>z(a.id),className:"data-[state=checked]:bg-emerald-500 data-[state=unchecked]:bg-amber-400"})]}),e.jsxs("div",{className:"space-y-3",children:[e.jsxs("div",{className:"grid grid-cols-3 gap-2",children:[e.jsx("button",{onClick:()=>_(a),className:"flex items-center justify-center p-2.5 text-xs font-medium rounded-lg bg-white/70 dark:bg-gray-800/70 hover:bg-red-50 dark:hover:bg-red-900/30 text-gray-700 dark:text-gray-300 hover:text-red-600 dark:hover:text-red-400 transition-all border border-white/50 dark:border-gray-700/50",title:"Deletar Cartão",children:e.jsx(ne,{className:"w-4 h-4"})}),e.jsx("button",{onClick:()=>W(a),className:"flex items-center justify-center p-2.5 text-xs font-medium rounded-lg bg-white/70 dark:bg-gray-800/70 hover:bg-purple-50 dark:hover:bg-purple-900/30 text-gray-700 dark:text-gray-300 hover:text-purple-600 dark:hover:text-purple-400 transition-all border border-white/50 dark:border-gray-700/50",title:"Visualizar Cartão",children:e.jsx(se,{className:"w-4 h-4"})}),e.jsx("button",{onClick:()=>O(a),className:`flex items-center justify-center p-2.5 text-xs font-medium rounded-lg transition-all border ${v.has(a.id)?"bg-emerald-100 dark:bg-emerald-900/30 text-emerald-700 dark:text-emerald-400 border-emerald-300 dark:border-emerald-600":"bg-white/70 dark:bg-gray-800/70 hover:bg-emerald-50 dark:hover:bg-emerald-900/30 text-gray-700 dark:text-gray-300 hover:text-emerald-600 dark:hover:text-emerald-400 border-white/50 dark:border-gray-700/50"}`,title:v.has(a.id)?"Link Copiado!":"Copiar Link",children:v.has(a.id)?e.jsx(te,{className:"w-4 h-4"}):e.jsx(re,{className:"w-4 h-4"})})]}),e.jsx(x,{variant:"ghost",size:"sm",onClick:()=>L.visit(`/admin/cards/${a.id}/activations`),className:"text-sm text-blue-600 hover:text-blue-800 p-0 h-auto font-normal justify-start",children:"📊 Ver Ativações"}),e.jsxs("div",{className:"flex gap-2",children:[e.jsx("button",{onClick:()=>I(a),className:"flex-1 flex items-center justify-center p-3 rounded-lg bg-white/70 dark:bg-gray-800/70 text-emerald-500 hover:text-emerald-600 hover:bg-emerald-50 dark:hover:bg-emerald-900/30 shadow-sm hover:shadow-md transition-all border border-white/50 dark:border-gray-700/50",title:"Compartilhar no WhatsApp",children:e.jsx(oe,{className:"w-5 h-5"})}),e.jsx("button",{onClick:()=>P(a),className:"flex-1 flex items-center justify-center p-3 rounded-lg bg-white/70 dark:bg-gray-800/70 text-blue-500 hover:text-blue-600 hover:bg-blue-50 dark:hover:bg-blue-900/30 shadow-sm hover:shadow-md transition-all border border-white/50 dark:border-gray-700/50",title:"Compartilhar via Email",children:e.jsx(T,{className:"w-5 h-5"})}),a.email?e.jsx("button",{onClick:()=>V(a),className:"flex-1 flex items-center justify-center p-3 rounded-lg bg-white/70 dark:bg-gray-800/70 text-purple-500 hover:text-purple-600 hover:bg-purple-50 dark:hover:bg-purple-900/30 shadow-sm hover:shadow-md transition-all border border-white/50 dark:border-gray-700/50",title:`Enviar email de ativação para ${a.email}`,children:e.jsx(T,{className:"w-5 h-5"})}):e.jsxs(U,{children:[e.jsx(H,{asChild:!0,children:e.jsx("button",{className:"flex-1 flex items-center justify-center p-3 rounded-lg bg-white/70 dark:bg-gray-800/70 text-gray-500 hover:text-gray-600 hover:bg-gray-50 dark:hover:bg-gray-900/30 shadow-sm hover:shadow-md transition-all border border-white/50 dark:border-gray-700/50",title:"Mais opções de compartilhamento",children:e.jsx(le,{className:"w-5 h-5"})})}),e.jsxs(Y,{align:"end",className:"w-36",children:[e.jsxs(f,{onClick:()=>u(a,"twitter"),children:[e.jsx("span",{className:"mr-2",children:"🐦"}),"Twitter"]}),e.jsxs(f,{onClick:()=>u(a,"linkedin"),children:[e.jsx("span",{className:"mr-2",children:"💼"}),"LinkedIn"]}),e.jsxs(f,{onClick:()=>u(a,"facebook"),children:[e.jsx("span",{className:"mr-2",children:"📘"}),"Facebook"]}),e.jsxs(f,{onClick:()=>u(a,"sms"),children:[e.jsx("span",{className:"mr-2",children:"💬"}),"SMS"]})]})]})]})]})]})},a.id))})}),e.jsx(J,{open:D,onOpenChange:y,children:e.jsxs(K,{className:"w-[95vw] max-w-md",children:[e.jsx(Q,{children:e.jsx(X,{children:"Visualização do Cartão"})}),o&&e.jsx("div",{className:"space-y-4",children:e.jsxs("div",{className:"p-4 bg-gray-50 dark:bg-gray-800 rounded-lg",children:[e.jsx("h3",{className:"font-bold text-lg mb-2",children:o.name}),o.email&&e.jsxs("p",{className:"text-sm text-gray-600 dark:text-gray-400 mb-1",children:["📧 ",o.email]}),o.phone&&e.jsxs("p",{className:"text-sm text-gray-600 dark:text-gray-400 mb-1",children:["📱 ",o.phone]}),o.whatsapp&&e.jsxs("p",{className:"text-sm text-gray-600 dark:text-gray-400 mb-1",children:["💬 ",o.whatsapp]}),o.company&&e.jsxs("p",{className:"text-sm text-gray-600 dark:text-gray-400 mb-1",children:["🏢 ",o.company]}),o.job_title&&e.jsxs("p",{className:"text-sm text-gray-600 dark:text-gray-400 mb-1",children:["💼 ",o.job_title]}),o.website&&e.jsxs("p",{className:"text-sm text-gray-600 dark:text-gray-400 mb-1",children:["🌐 ",o.website]}),e.jsxs("div",{className:"mt-4 pt-4 border-t border-gray-200 dark:border-gray-700",children:[e.jsxs("p",{className:"text-xs text-gray-500",children:["Status: ",e.jsx("span",{className:o.status==="activated"?"text-green-600":"text-amber-600",children:o.status==="activated"?"Ativo":"Pendente"})]}),e.jsxs("p",{className:"text-xs text-gray-500",children:["Clicks: ",o.clickCount||0]}),e.jsxs("p",{className:"text-xs text-gray-500",children:["Código: ",o.code]})]})]})})]})})]})]})})};export{Pe as default};
